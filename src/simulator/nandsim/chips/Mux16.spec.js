import { Mux16 } from "./index.js";
import { sim } from "../Gate.js";

describe("Mux16", () => {
  // Define connections
  let mux = new Mux16();

  // Define Inputs
  mux.a.name("a").input();
  mux.b.name("b").input();
  mux.sel.name("sel").input();

  // Define Outputs
  mux.out.name("out").output();

  test.each`
    a                     | b                     | sel    | out
    ${"0000000000000000"} | ${"0000000000000000"} | ${"0"} | ${"0000000000000000"}
    ${"0000000000000000"} | ${"0000000000000000"} | ${"1"} | ${"0000000000000000"}
    ${"0000000000000000"} | ${"0001001000110100"} | ${"0"} | ${"0000000000000000"}
    ${"0000000000000000"} | ${"0001001000110100"} | ${"1"} | ${"0001001000110100"}
    ${"1001100001110110"} | ${"0000000000000000"} | ${"0"} | ${"1001100001110110"}
    ${"1001100001110110"} | ${"0000000000000000"} | ${"1"} | ${"0000000000000000"}
    ${"1010101010101010"} | ${"0101010101010101"} | ${"0"} | ${"1010101010101010"}
    ${"1010101010101010"} | ${"0101010101010101"} | ${"1"} | ${"0101010101010101"}
  `("[$a, $b][$sel] == $out", ({ a, b, sel, out }) => {
    sim.setPins({ a, b, sel });
    expect(sim.readPins("a", "b", "sel")).toEqual({ a, b, sel });
    sim.evalOutputs();
    expect(sim.readPins("out")).toEqual({ out });
  });
});
